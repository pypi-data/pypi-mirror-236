"use strict";(self.webpackChunk_jlab_enhanced_favorites=self.webpackChunk_jlab_enhanced_favorites||[]).push([[427],{427:(e,t,a)=>{a.r(t),a.d(t,{IFavorites:()=>I,default:()=>W});var i=a(614),s=a(854),o=a(44),n=a(684),r=a(800),l=a(697),v=a(797),c=a(778),d=a(29),h=a.n(d),m=a(901);const f=new r.LabIcon({name:"jupyterlab-favorites:filledStar",svgstr:'<svg\n  xmlns="http://www.w3.org/2000/svg"\n  viewBox="0 0 24 24"\n>\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n  \x3c!-- The "fill" property has been modified from the original --\x3e\n  <path class="jp-icon3"  fill="rgb(97,97,97)"\n    d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"\n  />\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n</svg>'}),g=new r.LabIcon({name:"jupyterlab-favorites:star",svgstr:'<svg\n  xmlns="http://www.w3.org/2000/svg"\n  viewBox="0 0 24 24"\n>\n  \x3c!-- The "fill" property has been modified from the original --\x3e\n  <path class="jp-icon3"  fill="rgb(97,97,97)"\n    d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"\n  />\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n</svg>'});function p(e){return e?f:g}function u(e){return[i.PathExt.basename(e),i.PathExt.dirname(e)]}function F(e){return(e?"Remove":"Add")+" Favorite"}function b(e,t){return i.PathExt.join(e,t)}const y=e=>{const{favorite:t,handleClick:a}=e;let i,[s,o]=u(t.path);return t.name?(s=t.name,o=""):o="/"+o,i=t.iconLabel?r.LabIcon.resolve({icon:t.iconLabel}):"directory"===t.contentType?r.folderIcon:r.fileIcon,d.createElement("div",{className:"jp-Favorites-item",title:b(t.root,t.path),onClick:e=>{a(t)},"data-path":t.path},d.createElement(i.react,{className:"jp-Favorites-itemIcon",tag:"span"}),d.createElement("span",{className:"jp-Favorites-itemText"},s,d.createElement("span",{className:"jp-Favorites-dirname"},o)))},w=e=>{const t=e.currentPath;return t?d.createElement(r.UseSignal,{signal:e.manager.favoritesChanged,initialSender:e.manager},(a=>{var i;const s=null!==(i=null==a?void 0:a.hasFavorite(t))&&void 0!==i&&i,o=p(s);return d.createElement("button",{className:"jp-ToolbarButtonComponent",title:F(s),onClick:a=>{e.handleClick(t)}},d.createElement(o.react,{className:"jp-Favorites-BreadCrumbs-Icon",tag:"span"}))})):null};class C extends r.ReactWidget{constructor(e,t){super(),this.pathChanged=new m.Signal(this),this.manager=e,this.filebrowser=t,this.addClass("jp-Favorites"),this.filebrowser.model.pathChanged.connect(((e,t)=>{const a=t.newValue;this.pathChanged.emit(a)}))}render(){return d.createElement(r.UseSignal,{signal:this.manager.favoritesChanged,initialSender:this.manager,initialArgs:this.manager.visibleFavorites()},((e,t)=>d.createElement("div",null,d.createElement(r.UseSignal,{signal:e.visibilityChanged,initialSender:e,initialArgs:e.isVisible()},((e,a)=>a&&d.createElement(d.Fragment,null,d.createElement("div",{className:"jp-Favorites-header"},"Favorites"),d.createElement("div",{className:"jp-Favorites-container"},(null!=t?t:[]).map((t=>d.createElement(y,{key:`favorites-item-${t.path}`,favorite:t,handleClick:e.handleClick.bind(e)})))),d.createElement("div",{className:"jp-FileBrowser-header"},"File Browser")))))))}}var R,_,x,M=a(930);!function(e){e.favorites="jupyterlab-favorites"}(R||(R={})),function(e){e.addOrRemoveFavorite=`${R.favorites}:add-or-remove-favorite`,e.removeFavorite=`${R.favorites}:remove-favorite`,e.renameFavorite=`${R.favorites}:rename-favorite`,e.openFavorite=`${R.favorites}:open-favorite`,e.toggleFavoritesWidget=`${R.favorites}:toggle-favorites-widget`,e.restoreDefaults=`${R.favorites}:restore-defaults`,e.clearFavorites=`${R.favorites}:clear-favorites`}(_||(_={})),function(e){e.themes="@jupyterlab/apputils-extension:themes",e.favorites="@jlab-enhanced/favorites:favorites"}(x||(x={}));const I=new M.Token("jupyterlab-favorites:IFavorites");class S{constructor(e,t,a,i){this.favoritesChanged=new m.Signal(this),this.visibilityChanged=new m.Signal(this),this._favorites=[],this._showWidget=!1,this._showWidget=!0,this._serverRoot=e,this._commandRegistry=t,this._settingsRegistry=a,this._contentsManager=i,this.favoritesMenu=new c.Menu({commands:this._commandRegistry}),this.favoritesMenu.title.label="Favorites",this._settingsRegistry.pluginChanged.connect((async(e,t)=>{t===x.favorites&&this.loadFavorites()})),this.favoritesChanged.connect((async e=>{this._showWidget=await this.loadShowWidget(),this.syncFavoritesMenu(),this.visibilityChanged.emit(this.isVisible())}))}get serverRoot(){return this._serverRoot}get favorites(){return this._favorites.filter((e=>e.root===this.serverRoot))}set favorites(e){this._favorites=e,this.favoritesChanged.emit(this.visibleFavorites())}async addFavorite(e){const t=this._favorites.slice(),a=t.findIndex((t=>t.root===this.serverRoot&&t.path===e.path)),i=t[a];i?i.hidden&&(i.hidden=!1,this.saveSettings({favorites:t})):this.saveSettings({favorites:t.concat([e])})}clearFavorites(){this.clearFavoritesOrRestoreDefaults(!0)}init(){this.loadFavorites()}isVisible(){return this._showWidget&&this.visibleFavorites().length>0}hasFavorite(e){return this.visibleFavorites().findIndex((t=>t.path===e))>=0}handleClick(e){this._commandRegistry.execute(_.openFavorite,{favorite:e})}async overwriteSettings(e){const t=JSON.stringify(e,null,4);this._settingsRegistry.upload(x.favorites,t)}async renameFavorite(e,t){const a=this._favorites.slice(),i=a.find((t=>t.root===this.serverRoot&&t.path===e));i&&(i.name=t,this.saveSettings({favorites:a}))}async removeFavorite(e){const t=this._favorites.slice(),a=t.findIndex((t=>t.root===this.serverRoot&&t.path===e)),i=t[a];i&&(i.default?i.hidden=!0:t.splice(a,1),this.saveSettings({favorites:t}))}async removeFavoriteIfInvalid(e){this._contentsManager.get(e.path,{content:!1}).catch((t=>{404===t.response.status&&this.removeFavorite(e.path)}))}restoreDefaults(){this.clearFavoritesOrRestoreDefaults(!1)}async saveSettings(e){void 0!==e.favorites&&await this._settingsRegistry.set(x.favorites,"favorites",e.favorites),void 0!==e.showWidget&&this._settingsRegistry.set(x.favorites,"showWidget",e.showWidget)}visibleFavorites(){return this.favorites.filter((e=>!e.hidden)).sort(((e,t)=>e.contentType===t.contentType?u(e.path)<=u(t.path)?-1:1:e.contentType<t.contentType?-1:1))}clearFavoritesOrRestoreDefaults(e){const t=this._favorites,a=[];t.forEach((t=>{t.default&&(t.hidden=e,a.push(t))})),this.overwriteSettings({favorites:a})}async loadFavorites(){var e;const t=await this._settingsRegistry.get(x.favorites,"favorites");this.favorites=null!==(e=t.composite)&&void 0!==e?e:[]}async loadShowWidget(){var e;return null!==(e=(await this._settingsRegistry.get(x.favorites,"showWidget")).composite)&&void 0!==e&&e}syncFavoritesMenu(){this.favoritesMenu.clearItems();const e=this.visibleFavorites();e.length>0&&(e.forEach((e=>{this.favoritesMenu.addItem({command:_.openFavorite,args:{favorite:e}})})),this.favoritesMenu.addItem({type:"separator"}));const t=this._showWidget;this.favoritesMenu.addItem({command:_.toggleFavoritesWidget,args:{showWidget:t}}),this.favoritesMenu.addItem({command:_.restoreDefaults}),this.favoritesMenu.addItem({command:_.clearFavorites})}}var j=a(861);const W={id:R.favorites,autoStart:!0,requires:[s.IFileBrowserFactory,n.ISettingRegistry],provides:I,optional:[s.IDefaultFileBrowser,o.IMainMenu],activate:(e,t,a,s,o)=>{console.log("JupyterLab extension jupyterlab-favorites is activated!");const n=e.docRegistry,{commands:d,serviceManager:m}=e,f=new S(i.PageConfig.getOption("serverRoot")||"Jupyter Server Root",d,a,m.contents);if(f.init(),s){const e=new C(f,s);s.layout.insertWidget(0,e);const t=s.node.querySelector(".jp-FileBrowser-crumbs");if(t){const e=()=>{if(!t.isConnected)return;s.model.pathChanged.disconnect(e);const a=r.ReactWidget.create(h().createElement(r.UseSignal,{signal:s.model.pathChanged,initialSender:s.model},(e=>h().createElement(w,{currentPath:(null==e?void 0:e.path)||"",manager:f,handleClick:e=>{if(f.hasFavorite(e))f.removeFavorite(e);else{const t={root:f.serverRoot,contentType:"directory",iconLabel:r.folderIcon.name,path:e};f.addFavorite(t)}}}))));a.addClass("jp-Favorites-pinner"),c.Widget.attach(a,t);const i=new v.Throttler((()=>{t.insertAdjacentElement("beforeend",a.node)})),o=new MutationObserver((()=>{i.invoke()}));o.observe(t,{childList:!0}),s.disposed.connect((()=>{i.dispose(),o.disconnect()}))};s.model.pathChanged.connect(e),e()}}const u=()=>{const e=y.currentWidget;return e?(0,l.toArray)(e.selectedItems()):[]},{tracker:y}=t;if(d.addCommand(_.addOrRemoveFavorite,{execute:()=>{var e;const t=u();if(t.length>0){const a=t[0];if(f.hasFavorite(a.path))f.removeFavorite(a.path);else{const t=n.getFileTypeForModel(a);f.addFavorite({root:f.serverRoot,path:a.path,contentType:t.contentType,iconLabel:null===(e=t.icon)||void 0===e?void 0:e.name})}}},isVisible:()=>1===u().length,icon:()=>{const e=u()[0];return p(!f.hasFavorite(e.path))},label:()=>{const e=u()[0];return F(f.hasFavorite(e.path))}}),d.addCommand(_.removeFavorite,{execute:()=>{const t=e.contextMenuHitTest((e=>e.classList.contains("jp-Favorites-item"))).dataset.path;f.removeFavorite(t)},icon:g,label:"Remove Favorite"}),d.addCommand(_.renameFavorite,{execute:async t=>{var a;let{path:i,displayName:s}=t;if(i||(i=e.contextMenuHitTest((e=>e.classList.contains("jp-Favorites-item"))).dataset.path),i){if(!s){const e=await j.InputDialog.getText({title:"Rename favorite",label:`Name for favorite at '${i}'`,okLabel:"Rename",placeholder:"Display name"});s=e.button.accept&&null!==(a=e.value)&&void 0!==a?a:""}s&&f.renameFavorite(i,s)}},label:"Rename Favorite"}),d.addCommand(_.openFavorite,{execute:async e=>{const t=e.favorite,a=""===t.path?"/":t.path;await d.execute("filebrowser:open-path",{path:a})},label:e=>{const t=e.favorite;return b(t.root,t.path)}}),d.addCommand(_.toggleFavoritesWidget,{execute:async e=>{const t=e.showWidget;f.saveSettings({showWidget:!t})},label:e=>(e.showWidget?"Hide":"Show")+" Favorites Widget",isVisible:()=>f.visibleFavorites().length>0}),d.addCommand(_.restoreDefaults,{execute:()=>f.restoreDefaults(),label:"Restore Defaults"}),d.addCommand(_.clearFavorites,{execute:()=>f.clearFavorites(),label:"Clear Favorites"}),o){o.fileMenu.addGroup([{type:"submenu",submenu:f.favoritesMenu}],1);try{const e=o.fileMenu._ranks;let t=0,a=-1;for(let i=0;i<e.length;i++)1===e[i].rank&&(t+=1,a<0&&(a=i));if(2===t){const t=e[a];t.size=t.size+1,e.splice(a+1,1);const i=o.fileMenu.menu,s=i._items;let n=!1;for(let e=s.length-1;e>0;e--){const t=s[e];if("filebrowser:open-path"===t.command)break;n&&"separator"===t.type?i.removeItemAt(e):"submenu"===t.type&&"Favorites"===t.submenu.title.label&&(n=!0)}}}catch(e){console.log(e)}}return f}}}}]);