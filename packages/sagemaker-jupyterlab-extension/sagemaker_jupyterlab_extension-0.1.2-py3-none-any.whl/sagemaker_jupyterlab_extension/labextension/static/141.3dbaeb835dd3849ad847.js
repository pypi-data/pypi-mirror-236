"use strict";(self.webpackChunk_amzn_sagemaker_jupyterlab_extensions=self.webpackChunk_amzn_sagemaker_jupyterlab_extensions||[]).push([[141],{9075:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_e});var s=n(2044);const o={shutdown:"filemenu:shutdown"},i="git:clone",a="Sso",r=3e5,l=500,c=100,d=12e4,u={SignInSession:{closeButton:"Close",signInButton:"Sign In",saveButton:"Save",saveAndRenewButton:"Save and renew session",signinDialog:{title:"Please sign in again",restartSessionBody:"You were logged out of your account. You are not able to perform actions in your workplace at this time. Please start a new session.",loggedOutBody:"You were logged out of your account. Choose 'Sign In' to continue using this workplace."},sessionExpiredDialog:{title:"Session Expired please signin"},renewSessionDialog:{title:"Session expiring soon",defaultBodyText:"If your session expires, you could lose unsaved changes.",renewSessionBody:'To renew the session, log out from Studio App via "File" -> "Log Out" and then "Sign out" from AWS IAM Identity Center (successor to AWS SSO) user portal.',saveAllChanges:"Do you want to save all changes now?",renewSessionNow:"Do you want to renew your session now?",remindText:"Remind me in 5 minutes",soonExpiringSessionBody:"This session will expire soon.",contDownTimerMessage:"This session will expire ",fromNow:"from now.",loseUnsavedChanges:"If your session expires, you could lose unsaved changes."}},ResourceUsage:{cpuMetricTitle:"CPU:",memoryMetricTitle:"MEM:",storageMetricTitle:"Storage:",instanceMemoryProgressBarTitle:"Instance MEM",instanceMetricsTitle:"Instance",stoargeSpaceLimitDialog:{title:"Free up storage space"}},GitClone:{dialogTitle:"Clone Git Repository",repoTitle:"Git repositories URL(.git):",pathTitle:"Project directory to clone into:",afterCloningTitle:"After cloning",openReadMeFilesLabel:"Open README files.",cancelButton:"Cancel",cloneButton:"Clone",errors:{directoryNotExistTitle:"Destination directory doesn’t exist.",directoryNotExistBody:"The destination directory doesn’t exist. Create this directory and then try cloning the repository again. directory: ",localGitCloneExistTitle:"Repository clone already exists in project.",localGitCloneExistBody:"It looks like the Git repository has already been cloned into the given directory. Click Dismiss to navigate to your existing clone. repositoy: ",noURLErrorTitle:"Missing valid URL.",noURLErrorBody:'No URL listed to clone the repository. Please input a valid URL ending with ".git".',generalCloneErrorTitle:"Unable to clone repository to project.",generalCloneErrorBody:"Something went wrong when trying to clone the repository to your project. Please try again later. ",failedOptions:"Failed to handle additional options.",failedOptionsBody:"Something went wrong when trying to open README file within the repo.",invalidCloneUrlTitle:"Invalid URL provided",invalidCloneUrlBody:"The URL provided is not valid. Please input a valid URL to clone."}}},g={id:"@amzn/sagemaker-jupyterlab-extensions:hideshutdown",requires:[s.IMainMenu],autoStart:!0,activate:(e,t)=>{e.commands._commands.get(o.shutdown).isVisible=()=>!1}};var p=n(9801),m=n.n(p),h=n(6029),y=n.n(h),v=n(2418),w=n(2861);class E{constructor(){this._dismissTime=0,this._count=0}setDismissTime(e){e&&(this._dismissTime=e,this._count=1)}getDismissTime(){return this._dismissTime}}const f=()=>{const e=x("authMode");return e&&e[1]&&e[1]===a},x=e=>document.cookie.match("\\b"+e+'="?([^;]*)"?\\b'),b=()=>{const e=x("expiryTime"),t=x("ssoExpiryTimestamp");return f()&&t?Number(t[1]):e?Number(e[1]):null},S=(e,t)=>{var n,s;t?null===(n=e.serviceManager)||void 0===n||n.connectionFailure.disconnect(v.ConnectionLost):null===(s=e.serviceManager)||void 0===s||s.connectionFailure.connect(v.ConnectionLost)},C=()=>{const e=x("redirectURL");let t;try{if(t=new URL(e?e[1]:void 0),"http:"===t.protocol||"https:"===t.protocol)return t.toString()}catch(e){return}},M=(e,t)=>{const n=b(),s=window.open(e,"signin window","width=800, height=600");let o=!1;const i=window.setInterval((()=>{if(s&&s.closed&&!o)return void window.clearInterval(i);const e=b();if(null!==e&&null!==n&&(e>n||isNaN(e))){window.clearInterval(i),s&&s.close(),o=!0;for(const e of t)e.kernel.reconnect();w.Dialog.tracker.forEach((e=>e.reject()))}}),c)},R=async()=>{const{SignInSession:e}=u,{signinDialog:t}=e,n=C(),s=n?[w.Dialog.okButton({label:e.signInButton})]:[w.Dialog.cancelButton({label:e.closeButton})],o=n?y().createElement("div",null,t.loggedOutBody):y().createElement("div",null,t.restartSessionBody),i=new w.Dialog({title:t.title,body:o,buttons:s,hasClose:!1});return{sigInDialogResult:await i.launch(),confirmDialog:i}};var D=n(6797),T=n(6697),B=n(5987),k=n(4788),I=n(2679);const N=(e,t,n,s,o,i,a)=>{const l=b(),c=a(),d=c&&c+r;if(null===l)S(e,!1);else{const a=m().unix(l/1e3).diff(m()()),g=Date.now();((e,t,n)=>((e,t)=>-1===e&&t)(t,e)||((e,t)=>e<=0&&!t)(n,e))(f(),l,a)?(s(),(async(e,t,n)=>{const{SignInSession:s}=u,o=C();w.Dialog.tracker.forEach((e=>e.reject())),S(e,!0);const{sigInDialogResult:i,confirmDialog:a}=await R();if(i&&i.button)if(n(),o)M(C(),t);else if(i&&i.button.label===s.closeButton){const e=b(),t=e&&e/1e3,n=t&&m().unix(t).diff(m()());null!==n&&n&&n>r&&(a.dispose(),setTimeout((async()=>{await R()}),r))}else a.dispose(),M(C(),t)})(e,t,o)):a<=9e5&&(void 0===c||d&&g>d)?(s(),(async(e,t,n,s,o)=>{const{SignInSession:i}=u,{renewSessionDialog:a}=u.SignInSession,{renewSessionDialogResult:r,confirmDialog:l}=await(async()=>{const{SignInSession:e}=u,{renewSessionDialog:t}=u.SignInSession,n=C(),s=b(),o=s&&m().unix(s/1e3).fromNow(),i=`${t.contDownTimerMessage}${o}.`,a=`${f()?t.soonExpiringSessionBody:i}`,r=t.renewSessionBody,l=f()?y().createElement(y().Fragment,null,y().createElement("div",null,a," ",t.loseUnsavedChanges," ",t.saveAllChanges),y().createElement("div",null,r)):y().createElement("div",null,y().createElement("p",null,a),y().createElement("p",null,t.renewSessionNow)),c=[w.Dialog.okButton({label:t.remindText}),n&&w.Dialog.okButton({label:e.saveAndRenewButton})],d=new w.Dialog({title:t.title,body:l,buttons:c,hasClose:!1});return{renewSessionDialogResult:await d.launch(),confirmDialog:d}})();if(r&&r.button.label===a.remindText){const e=new E;0===e._count?(e.setDismissTime(Date.now()),o(e._dismissTime)):e.getDismissTime(),l.dispose(),s()}else r&&r.button.label===i.saveAndRenewButton&&(l.dispose(),n(),s(),f()||M(C(),t))})(0,t._sessions,n,o,i),S(e,!1)):S(e,!1)}},_={id:"@amzn/sagemaker-jupyterlab-extensions:sessionmanagement",requires:[],autoStart:!0,activate:async e=>{let t;const n=e.serviceManager.sessions,s=()=>{o.start()},o=((e,t,n,s,o,i,a)=>new D.Poll({auto:!0,factory:async()=>N(e,t,n,s,o,i,a),frequency:{interval:l,backoff:!0,max:d}}))(e,n,(()=>{const t=new B.TextModelFactory,n=new B.DocumentRegistry({textModelFactory:t}),s=new k.ServiceManager({}),o=new I.DocumentManager({registry:n,manager:s,opener:{open:e=>{},get opened(){return{connect:()=>!1,disconnect:()=>!1}}}});(0,T.each)(e.shell.widgets("main"),(e=>{const t=o.contextForWidget(e);void 0!==t&&t.save().then((()=>t.createCheckpoint())).catch((e=>{if("Cancel"!==e.message)throw e}))}))}),(()=>{o.stop()}),s,(e=>{t=e}),(()=>t));s()}};var U=n(4260);const A=[200,201];var L,$=n(4614);!function(e){e.POST="POST",e.GET="GET"}(L||(L={}));const P=async(e,t)=>{const n=k.ServerConnection.makeSettings(),s=$.URLExt.join(n.baseUrl,e);try{const e=await k.ServerConnection.makeRequest(s,{method:t},n);if(!A.includes(e.status))throw new Error("Unable to fetch data");return e}catch(e){throw Error(e)}};var j=n(5933);const G="8px",z="12px",F="rgba(0, 0, 0, 0.87)",O=j.css`
  border-bottom: solid 1px var(--sm-border-color2);
`,V="13px",Z=j.css`
  background-color: ${"#eeeeee"};
  border: solid 1px ${"#e0e0e0"};
  color: ${F};
  font-size: ${V};
  position: fixed;
  bottom: 25px;
`,W=j.css`
  margin: 0 ${z} ${G};
`,q=j.css`
  font-weight: bold;
  margin: ${G} 0 0 ${G};
`,H=(j.css`
  margin: 0 ${z} 0 ${"16px"};
`,j.css`
  border-radius: 10px;
  height: 100%;
  width: 30px;
`),Y=j.css`
  height: 24px;
  max-height: 24px;
  font-size: 13px;
  font-family: ${"-apple - system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans - serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'"};
  color: ${F};
  line-height: 24px;
  padding: 0 5px;

  &:hover {
    background-color: ${"#bdbdbd"};
  }
`,J=(j.css`
  padding-left: 4px;
`,j.css`
  display: flex;
  justify-content: flex-start;
  align-items: center;
  margin: 6px 12px;
`),K=j.css`
  color: ${F};
  font-size: ${V};
  padding-right: 5px;
`,Q=j.css`
  border-radius: 10px;
  width: 40px;
  margin: 0 0 2px 4px;
  height: 6px !important;
`,X=(j.css`
  border-radius: 10px;
  display: inline-block;
  width: 40px;
  height: 8px;
`,j.css`
  display: flex;
  align-items: center;
`);var ee=n(3221);const te=({value:e,singleProgressBarStyle:t,displayValue:n,label:s,labelClassName:o,conatinerClassName:i})=>y().createElement("div",{role:"container","data-testid":"linear-progress-bar-container"},y().createElement("div",{className:i},s&&y().createElement("span",{className:o},s," ",n,"%"),y().createElement(ee.Z,{"data-testid":"linear-progress-bar",className:t,variant:"determinate",value:e}))),ne="jlStudio-",se=`${ne}ResourceUsageWidgetContainer`,oe=`${ne}MetricsWidgetContainer`,ie=({onClickHandler:e,instanceMetricsResponse:t,instanceMetricsDisplayValue:n})=>{const[s,o]=(0,h.useState)(!1),[i,a]=(0,h.useState)(0),[r,l]=(0,h.useState)(0),[c,d]=(0,h.useState)(0),[g,p]=(0,h.useState)(!1),m=e=>e&&void 0!==e?Math.round(e):0,v=e=>0===e?"0.0":e&&void 0!==e?e.toFixed(2).toString():"--";(0,h.useEffect)((()=>{if(void 0!==t&&(null==t?void 0:t.metrics)){const{metrics:e}=t,n=e.cpu.cpu_percentage,s=e.memory.memory_percentage,o=e.storage.used_space_in_bytes,i=e.storage.total_space_in_bytes,r=o&&i&&o/i*100;a(n),l(s),d(r)}}),[t]),(0,h.useEffect)((()=>{if(c&&c>95&&!1===g){const{stoargeSpaceLimitDialog:e}=u.ResourceUsage;w.Notification.info(e.title),p(!0)}}),[g,c]);const{instanceMemoryProgressBarTitle:E,instanceMetricsTitle:f,cpuMetricTitle:x,memoryMetricTitle:b,storageMetricTitle:S}=u.ResourceUsage;return y().createElement("div",{className:`${se} ${Y}`},y().createElement("div",{"data-testid":"clickHandler",className:X,onClick:()=>(t=>{o(!t),e()})(s)},E," ",void 0===n?y().createElement(ee.Z,{className:Q}):y().createElement("div",{className:X},y().createElement(ee.Z,{className:Q,variant:"determinate",value:0|n}),n?Math.round(n):0,"%")),s&&y().createElement("div",{className:`${oe} ${Z}`},y().createElement("div",{className:O},y().createElement("div",{className:q},f),y().createElement("div",{className:W},y().createElement("div",null,y().createElement(te,{value:m(i),displayValue:v(i),label:x,labelClassName:K,singleProgressBarStyle:H,conatinerClassName:J}),y().createElement(te,{value:m(r),displayValue:v(r),label:b,labelClassName:K,singleProgressBarStyle:H,conatinerClassName:J}),y().createElement(te,{value:m(c),displayValue:v(c),label:S,labelClassName:K,singleProgressBarStyle:H,conatinerClassName:J}))))))};class ae extends w.ReactWidget{constructor(){super(),this.clickHandler=()=>{this.update()},this.getInstanceMetrics=async()=>{await P("aws/sagemaker/api/instance/metrics",L.GET).then((e=>{e&&e.json().then((e=>{var t,n;this._instanceMetricsResponse=e||null,(null===(t=this._instanceMetricsResponse)||void 0===t?void 0:t.metrics.memory)?this._instanceMetricsDisplayValue=null===(n=this._instanceMetricsResponse)||void 0===n?void 0:n.metrics.memory.memory_percentage:this._instanceMetricsDisplayValue=void 0}))})),this.update()},this._getInstanceMetricsLoop=setInterval(this.getInstanceMetrics,5e3),this._instanceMetricsResponse=null,this._instanceMetricsDisplayValue=void 0}render(){return y().createElement(ie,{onClickHandler:this.clickHandler,instanceMetricsResponse:this._instanceMetricsResponse,instanceMetricsDisplayValue:this._instanceMetricsDisplayValue})}}const re={id:"@amzn/sagemaker-jupyterlab-extensions:resourceusage",requires:[U.IStatusBar],autoStart:!0,activate:async(e,t)=>{const n=new ae;t.registerStatusItem("@amzn/sagemaker-jupyterlab-extensions:resourceusage:resource-usage-widget",{item:n,align:"left",isActive:()=>!0,rank:100})}};var le=n(3854),ce=n(3020);const de=j.css`
  .MuiInputBase-input MuiInput-input {
    width: 400px;
    margin-bottom: 20px;
  }
`,ue=({label:e,id:t,helperText:n,error:s,handleChange:o,regEx:i})=>{const[a,r]=(0,h.useState)(""),[l,c]=(0,h.useState)(!0);return y().createElement(ce.Z,{variant:"standard",className:de,"data-testid":"text-field-container",error:!l,id:t,label:e,helperText:n,value:a,onChange:e=>(e=>{r(e.target.value);const t=new RegExp(i);c(t.test(e.target.value)),o(e.target.value)})(e)})},ge=j.css`
  z-index: 2;
`,pe=j.css`
  width: 460px;
  input {
    width: 460px;
  }
  .MuiFormControl-root.MuiTextField-root {
    margin-bottom: 20px;
  }
`;j.css`
  margin-bottom: 20px;
`;var me=n(5994);const he=(e=!1)=>j.css`
  color: var(--jp-color-root-light-800);
  font-weight: 400;
  font-size: var(--jp-ui-font-size1);
  line-height: var(--jp-ui-font-size1);
  margin-bottom: var(--jp-ui-font-size1);
  ${e&&"\n    &:after {\n      content: '*';\n      color: var(--jp-error-color1);\n    }\n  "}
`,ye=j.css`
  margin-top: 20px;
`,ve=({options:e,handleChange:t,label:n,freeSolo:s})=>{const o=(e,n)=>{t(n)};return h.createElement("div",{className:ye},h.createElement("label",{className:he(!0)},n),h.createElement(me.Z,{id:"autocomplete",freeSolo:s,autoSelect:!0,onChange:(e,t)=>o(0,t),onInputChange:(e,t)=>o(0,t),options:e.map((e=>e.label)),renderInput:e=>h.createElement(ce.Z,{...e,variant:"outlined",size:"small",margin:"dense"})}))};var we=n(3283),Ee=n(5281);const fe=({label:e,id:t,handleChange:n})=>{const[s,o]=(0,h.useState)(!0);return y().createElement(y().Fragment,null,y().createElement(Ee.Z,{control:y().createElement(we.Z,{"data-testid":"checkbox-field",inputProps:{"aria-label":"controlled"},checked:s,onChange:e=>{o(e.target.checked),n(e.target.checked)},id:t}),label:e}))},xe=({gitRepositories:e,setGitURL:t,setPath:n,setOpenREADME:s})=>{const[o,i]=(0,h.useState)(""),[a,r]=(0,h.useState)(""),[l,c]=(0,h.useState)(!0),[d,g]=(0,h.useState)([]),{repoTitle:p,pathTitle:m,openReadMeFilesLabel:v}=u.GitClone;return(0,h.useEffect)((()=>{if(e&&e.GitCodeRepositories.length>=0){const t=[];e.GitCodeRepositories.length>0&&e.GitCodeRepositories.forEach((e=>t.push({value:e,label:e}))),g(t)}}),[e]),y().createElement("div",{className:pe},y().createElement(ve,{"data-testid":"autocomplete-field-container",label:p,options:d,value:a,handleChange:e=>{r(e),t(e)},freeSolo:!0}),y().createElement(ue,{"data-testid":"text-field-container",error:!1,id:"path",label:m,helperText:"",valuePassed:o,handleChange:e=>{i(e),n(e)},regEx:"^([A-Za-z]*|[0-9]*|[/]*|[.]*|[A-Za-z0-9/.]*)$"}),y().createElement(fe,{label:v,id:"openReadMe",handleChange:e=>{c(e),s(e)},checked:l}))};class be extends w.ReactWidget{constructor(){super(),this.setGitURL=e=>{this.URL=e},this.setPath=e=>{this.path=e},this.setOpenREADME=e=>{this.openREADME=e},this.getGitRepositories=async()=>{await P("aws/sagemaker/api/git/list-repositories",L.GET).then((e=>{e&&e.json().then((e=>{this._gitCloneRepositories=e||null,this.update()}))}))},this.URL="",this.path="",this.openREADME=!0,this._gitCloneRepositories=null,this.getGitRepositories()}getValue(){return{URL:this.URL,path:this.path,openREADME:this.openREADME}}render(){return y().createElement(xe,{gitRepositories:this._gitCloneRepositories,setGitURL:this.setGitURL,setPath:this.setPath,setOpenREADME:this.setOpenREADME})}}var Se,Ce=n(6505);!function(e){e[e.CanClone=0]="CanClone",e[e.NotExist=1]="NotExist",e[e.AlreadyCloned=2]="AlreadyCloned"}(Se||(Se={}));const Me=[{name:"README.ipynb",factory:"Notebook"},{name:"README.md",factory:"Markdown Preview"}],Re=async(e,t,n)=>{const{repoPath:s,openREADME:o}=n;if(await e.execute("filebrowser:go-to-path",{path:s}),!0===o)try{await(async(e,t,n)=>{const s=await t.get(e);if("directory"===s.type){const t=Me.find((e=>s.content.some((t=>t.name===e.name))));t&&await n.execute("docmanager:open",{path:$.PathExt.join(e,t.name),factory:t.factory})}})(s,t,e)}catch(e){}},De=async(e,t)=>{let n;try{n=await t.get(e)}catch(e){return!1}return"directory"===n.type};var Te=n(8778);const{dialogTitle:Be,cancelButton:ke,cloneButton:Ie,errors:Ne}=u.GitClone,_e=[g,_,re,{id:"@amzn/sagemaker-jupyterlab-extensions:gitclone",requires:[le.IFileBrowserFactory,le.IDefaultFileBrowser,s.IMainMenu,Ce.ITranslator],autoStart:!0,activate:async(e,t,n,s,o)=>{const{commands:a,serviceManager:r}=e,l=r.contents,c=(o=o||Ce.nullTranslator).load("sagemaker_studio");a.addCommand(i,{label:"Git Clone Repo",caption:"",execute:()=>(async(e,t,n,s)=>{var o,i;const a=t.model;let r="";const l=null===(i=null===(o=null==e?void 0:e.tracker)||void 0===o?void 0:o.currentWidget)||void 0===i?void 0:i.model.path;let c,d=null!=l?l:"",g=!0,p=!0;const m=new w.Dialog({title:Be,body:new be,focusNodeSelector:"input",buttons:[w.Dialog.cancelButton({label:ke}),w.Dialog.okButton({label:Ie})],hasClose:!1});m.addClass(ge);try{c=await m.launch()}catch(e){return}if(!c.button.accept||!c.value)return;var h;if(({URL:r,path:d,openREADME:g,findEnvironment:p}=c.value),"string"==typeof(h=d)&&h.length>0||(d="./"),!(e=>/^(https:\/\/|git)([:/@.~\-_a-zA-Z0-9])+$/.test(e))(r))return void await(0,w.showErrorMessage)(Ne.invalidCloneUrlTitle,{message:Ne.invalidCloneUrlBody});const y=(e=>{const t=$.URLExt.parse(e);return $.PathExt.basename(t.pathname,".git")})(r),v=$.PathExt.join(d,y);let E;try{E=await(async(e,t,n,s)=>{const{errors:o}=u.GitClone;return await De(t,e)?await De(s,e)?(await(0,w.showErrorMessage)(o.localGitCloneExistTitle,{message:o.localGitCloneExistBody+n}),Se.AlreadyCloned):Se.CanClone:(await(0,w.showErrorMessage)(o.directoryNotExistTitle,{message:o.directoryNotExistBody+t}),Se.NotExist)})(n,d,r,v)}catch(e){}const f={repoPath:v,openREADME:g,findEnvironment:p};E===Se.CanClone?(async(e,t,n,s,o,i)=>{const{errors:a}=u.GitClone,r=await e.execute("terminal:create-new");let l="";o&&(l+=`cd ${o} && `),l+=`git clone ${i} && exit\r`;try{const o=r.content;o.session.send({type:"stdin",content:[l]}),o.session.connectionStatusChanged.connect((async s=>{if("disconnected"===s.connectionStatus)try{await Re(e,t,n)}catch(e){await(0,w.showErrorMessage)(a.failedOptions,a.failedOptionsBody,[w.Dialog.warnButton({label:"DISMISS"})])}})),await s.refresh()}catch(e){r.dispose(),await(0,w.showErrorMessage)(a.generalCloneErrorTitle,{message:a.generalCloneErrorBody+e})}})(s,n,f,a,d,r):E===Se.AlreadyCloned&&Re(s,n,f)})(t,n,l,a),isEnabled:()=>e.serviceManager.terminals.isAvailable()}),((e,t,n,s)=>{const o=new Te.Menu({commands:t.commands});o.title.label=s.__("Git"),o.addItem({command:i}),n.addMenu(o)})(0,e,s,c)}}]}}]);