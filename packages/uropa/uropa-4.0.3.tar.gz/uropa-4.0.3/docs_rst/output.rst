Output files
============
UROPA provides multiple output files, each providing valuable information in either a more extended or a more condense way in order to cover the needs of a user.                                          
Details are given below:

File overview
-------------

- **allhits.txt**: Basic output table, reports for each peak all valid annotations and additionally NA rows for peaks without valid annotation. 

- **finalhits.txt**: Filtered output table, it reports the best (closest) feature according to the config criteria for each peak. If multiple queries are given, it reports the best annotation taking multiple queries into account.

- **finalhits.bed**: Similar tp finalhits.txt in bed format. This means there is no header, the column order is as followed: peak_chr	peak_start	peak_end	peak_id	peak_strand	peak_score	feature	feat_start	feat_end	feat_strand	feat_anchor	distance	genomic_location **+ all attributes that are given in the config file** + <name of matching query>

- **summary.pdf**: Statistical summary of the UROPA annotation generated by using the ``-s`` parameter.

.. note::
	If no prefix is specified, the result files will be stored in the working diractory with the basename of the config file.
	For example,``uropa -i histonMarkPeaks.json`` leads to an allhits file called histonMarkPeaks_allhits.txt stored in the working directory.
	
	With specified prefix, the result files will be stored in the working diractory with the prefix as part of the output file names.
	``uropa -i histonMarkPeaks.json -p abc`` results in an allhits file called abc_allhits.txt.
	But if for instance the prefix would be defined as ``-p xy/abc`` all results would be stored in folder xy, 
	which is be created if it does not exist already, with abc as prefixes of the output files.
	
Output columns explanation
--------------------------

The four output tables mentioned above contain informative columns about the performed peak annotation:

- **peak_id, peak_start, peak_center, peak_end, peak_strand**: Peak information with id if available, otherwise a peak id in chr:start-end format will be created.

- **feature, feat_start, feat_end, feat_strand**: The information of the genomic feature that annotates the peak as extracted by the GTF file.

- **feat_anchor**: The position of the annotated genomic feature which was used for distance calculation. If ``feature.anchor`` is given in config, only this will be used.                                    If multiple ``feature.anchor`` were given, the distance to all of them is calculated and the minimum distance is chosen.

- **distance** : Absolute distance from peak center to feature anchor. Closest feature anchor if multiple are specified, see column feat_anchor.

- **genomic_location**: The position of the peak relative to the annotated feature direction (e.g. upstream = peak located upstream of the feature, see Figure 2 in :doc:`/uropa-example`).

- **feat_ovl_peak**: Percentage of the peak that is covered by the feature (1.0 = 100%, this corresponds to the genomic_location "PeakInsideFeature").

- **peak_ovl_feat**: Percentage of the feature that is covered by the peak (1.0 corresponds to the genomic_location "FeatureInsidePeak").

- **gene_name, gene_id, gene_type,...**: Attributes that have been given in the key ``show.atttributes`` with their values extracted from the GTF.

- **name**: The query name for the current annotation.

.. hint:: 
	- If ``filter.attribute`` key is used, make sure to specify these attributes are also selected in the ``show.attributes`` key, to have an easy confirmation of the filtering.
	- Make sure to define attributes for a notification in the output. Otherwise the annotated peaks will be reported without any information of the assigned features.


Output files (one query)
------------------------
UROPA annotation with one query results in two output tables. Those are the allhits and finalhits. 
For a configuration as given below, the allhits is given in Table 1, and the finalhits is displayed in Table 2. 
Peak and annotation files are further described in the :doc:`/uropa-example` section. 

The UROPA annotation process for one query can run into three cases for each peak:

- **Case 1**: No query gives any feature for annotating the peak, this leads to no valid annotation at all -> NA row in allhits and finalhits. 
	
- **Case 2**: There is one valid annotation for the specified query -> annotation will be given in allhits and finalhits. 
	
- **Case 3**: There are multiple valid annotations for the specified query -> all valid annotations will be given in the allhits, the best annotation (smallest distance) will be presented in the finalhits.  


.. code:: json

    {
    "queries":[
            {"feature":"gene", "distance":10000, "feature.anchor":"start", "internals":"True", 
                "filter.attribute":"gene_type", "attribute.value":"protein_coding",
                "show.attributes":["gene_name","gene_type"]}], 
     "priority" : "False",
     "gtf":"gencode.v19.annotation.gtf" ,
     "bed":"ENCFF001VFA.bed"
    }

**Table 5.1:**  Excerpt of table allhits for one query as described in the configuration above.	

+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_id  | peak_chr | peak_start | peak_center | peak_end   | peak_strand | feature | feat_start | feature_end | feat_strand | feat_anchor | distance | genomic_location  | feat_ovl_peak | peak_ovl_feat | gene_name | gene_type      | query |
+==========+==========+============+=============+============+=============+=========+============+=============+=============+=============+==========+===================+===============+===============+===========+================+=======+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |           |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_355 | chr15    | 79211550   | 79217124    | 79222698   | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA        | NA             | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_356 | chr10    | 43902516   | 43904360.5  | 43906205   | .           | gene    | 43881065   | 43904614    | \-          | start       | 253      | overlapStart      | 0.57          | 0.09          | HNRNPF    | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |           |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_765 | chr5     | 98262863   | 98264852.5  | 98266842   | .           | gene    | 98190908   | 98262240    | \-          | start       | 261      | upstream          | 0.0           | 0.0           | CHD1      | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |           |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | gene    | 175810949  | 175815976   | \+          | start       | 937      | overlapStart      | 0.31          | 0.3           | NOP16     | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | gene    | 175815748  | 175816772   | \+          | start       | 1165     | FeatureInsidePeak | 0.22          | 1.0           | HIGD2A    | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | gene    | 175792471  | 175828666   | \+          | start       | 24442    | PeakInsideFeature | 1.0           | 0.14          | ARL10     | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |           |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+


**Table 5.2:**  Excerpt of table finalhits for one query as described in the configuration above.   

+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_id  | peak_chr | peak_start | peak_center | peak_end   | peak_strand | feature | feat_start | feature_end | feat_strand | feat_anchor | distance | genomic_location  | feat_ovl_peak | peak_ovl_feat | gene_name | gene_type      | query |
+==========+==========+============+=============+============+=============+=========+============+=============+=============+=============+==========+===================+===============+===============+===========+================+=======+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |           |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_355 | chr15    | 79211550   | 79217124    | 79222698   | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA        | NA             | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_356 | chr10    | 43902516   | 43904360.5  | 43906205   | .           | gene    | 43881065   | 43904614    | \-          | start       | 253      | overlapStart      | 0.57          | 0.09          | HNRNPF    | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |           |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_765 | chr5     | 98262863   | 98264852.5  | 98266842   | .           | gene    | 98190908   | 98262240    | \-          | start       | 261      | upstream          | 0.0           | 0.0           | CHD1      | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |           |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | gene    | 175810949  | 175815976   | \+          | start       | 937      | overlapStart      | 0.31          | 0.3           | NOP16     | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |           |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+-----------+----------------+-------+




As displayed in Table 1 and Table 2, peak 355 is a representative of Case 1. There is no valid annotation at all, thus there is an NA row in both output tables. 

The peaks 356 and 765 belong to Case 2, there is one valid annotation for them, their annotation is displayed in the same way in allhits and finalhits. 

Peak 769 has three valid annotations for the specified query (Case 3). All of them are displayed in the allhits output. 
In the finalhits only the best annotation, the one for gene NOP16 with the minimal distance of 937, is represented.


Output files (multiple queries)
--------------------------------
UROPA annotation with multiple queries and default priority results in at least two output tables. Those are the allhits and finalhits. If ``--output-by-query`` is given, there will be additional output files for each query. Furthermore, if the ``-s`` parameter is also added, the summary file is generated.              
With a configuration as given below, the generated output files are generated as presented in Tables 3 to 4 and Figure 1. 

Peak and annotation files are further described in the :doc:`/uropa-example` section.       

The UROPA annotation process for multiple queries allows an additional case in relation to the cases described for one query above:

- **Case 1 to 3** as described for one query

- **Case 4**: There are valid annotations for one peak for multiple queries -> all valid annotations will be given in the allhits, the best annotation (smallest distance across all queries) will be presented in the finalhits.

.. code:: json

    {
	"queries":[
            {"feature":"gene", "distance":10000, "feature.anchor":"start", "internals":"True", 
                "filter.attribute":"gene_type",  "attribute.value":"protein_coding",
                "show.attributes":["gene_name","gene_type"]},
            {"feature":"gene", "distance":10000, "feature.anchor":"start", "internals":"True", 
                "filter.attribute":"gene_type",  "attribute.value":"lincRNA"},
            {"feature":"gene", "distance":10000, "feature.anchor":"start", "internals":"True", 
                "filter.attribute":"gene_type",  "attribute.value":"misc_RNA"},
              ],
    "priority" : "False",
    "gtf": "gencode.v19.annotation.gtf",
    "bed": "ENCFF001VFA.peaks.bed"
    }
    
**Table 5.3:**  Excerpt of table allhits for three queries as described in the configuration above.
	
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_id  | peak_chr | peak_start | peak_center | peak_end   | peak_strand | feature | feat_start | feature_end | feat_strand | feat_anchor | distance | genomic_location  | feat_ovl_peak | peak_ovl_feat | gene_name     | gene_type      | query |
+==========+==========+============+=============+============+=============+=========+============+=============+=============+=============+==========+===================+===============+===============+===============+================+=======+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |               |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_355 | chr15    | 79211550   | 79217124    | 79222698   | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA            | NA             | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_355 | chr15    | 79211550   | 79217124    | 79222698   | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA            | NA             | 1     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_355 | chr15    | 79211550   | 79217124    | 79222698   | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA            | NA             | 2     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_356 | chr10    | 43902516   | 43904360.5  | 43906205   | .           | gene    | 43881065   | 43904614    | \-          | start       | 253      | overlapStart      | 0.57          | 0.09          | HNRNPF        | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_356 | chr10    | 43902516   | 43904360.5  | 43906205   | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA            | NA             | 1     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_356 | chr10    | 43902516   | 43904360.5  | 43906205   | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA            | NA             | 2     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |               |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_765 | chr5     | 98262863   | 98264852.5  | 98266842   | .           | gene    | 98190908   | 98262240    | \-          | start       | 261      | upstream          | 0.0           | 0.0           | CHD1          | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_765 | chr5     | 98262863   | 98264852.5  | 98266842   | .           | gene    | 98264875   | 98330717    | \+          | start       | 22       | overlapStart      | 0.5           | 0.03          | CTD-2007H13.3 | protein_coding | 1     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_765 | chr5     | 98262863   | 98264852.5  | 98266842   | .           | gene    | 98272342   | 98272451    | \-          | start       | 7598     | downstream        | 0.0           | 0.0           | Y_RNA         | protein_coding | 2     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |               |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | gene    | 175810949  | 175815976   | \+          | start       | 937      | overlapStart      | 0.31          | 0.3           | NOP16         | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | gene    | 175815748  | 175816772   | \+          | start       | 1165     | FeatureInsidePeak | 0.22          | 1.0           | HIGD2A        | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | gene    | 175792471  | 175828666   | \+          | start       | 24442    | PeakInsideFeature | 1.0           | 0.14          | ARL10         | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA            | NA             | 1     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA            | NA             | 2     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |               |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
	

**Table 5.4:**  Excerpt of table finalhits for three queries as described in the configuration above.

+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_id  | peak_chr | peak_start | peak_center | peak_end   | peak_strand | feature | feat_start | feature_end | feat_strand | feat_anchor | distance | genomic_location  | feat_ovl_peak | peak_ovl_feat | gene_name     | gene_type      | query |
+==========+==========+============+=============+============+=============+=========+============+=============+=============+=============+==========+===================+===============+===============+===============+================+=======+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |               |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_355 | chr15    | 79211550   | 79217124    | 79222698   | .           | NA      | NA         | NA          | NA          | NA          | NA       | NA                | NA            | NA            | NA            | NA             | 0,1,2 |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_356 | chr10    | 43902516   | 43904360.5  | 43906205   | .           | gene    | 43881065   | 43904614    | \-          | start       | 253      | overlapStart      | 0.57          | 0.09          | HNRNPF        | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |               |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_765 | chr5     | 98262863   | 98264852.5  | 98266842   | .           | gene    | 98264875   | 98330717    | \-          | start       | 22      | overlapStart       | 0.5           | 0.03          | CTD-2007H13.3 | protein_coding | 1     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |               |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| peak_769 | chr5     | 175814508  | 175816913.5 | 1751574319 | .           | gene    | 175810949  | 175815976   | \+          | start       | 937      | overlapStart      | 0.31          | 0.3           | NOP16         | protein_coding | 0     |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
| …        |          |            |             |            |             |         |            |             |             |             |          |                   |               |               |               |                |       |
+----------+----------+------------+-------------+------------+-------------+---------+------------+-------------+-------------+-------------+----------+-------------------+---------------+---------------+---------------+----------------+-------+
 

.. note:: 
	
Same as in the first example with one query, peak_355 has no valid annotation and is represented as NA row (correspond to Case 1). 
In the allhits (Table 5.3) there will be one NA row for each query. In the finalhits (Table 5.4) there will be only one NA row for all queries. 

The peak_356 has only for one query a valid annotation, as given in allhits and finalhits (Case 2). In allhits there are additional NA rows for this peak for the other queries without a hit. 

For peak_765 there are valid annotations for all given queries as displayed in the allhits, (Case 4). The best of these is the annotation for the lincRNA, therefore this annotation is displayed in the finalhits. 

This is different for peak_769. As described above this peaks equates to Case 3. With multiple queries, there will be additional NA rows for the invalid queries in the allhits.

Summary Visualisation
---------------------
In order to generate a global summary, one can apply the ``-s`` parameter during the command line call. 
This summary is visualising a global overview of the generated UROPA annotations, and several usefull plots, 
like the distribution of the annotated peaks to the features of interst and the genomic locations according to the features of interest.
Detailed information about the different plots and how they are dedicated to the different output file formats is explained below.  

**Overview of what can be found in the summary visualsation** 

- An abstract of the UROPA annotation including the used peak and annotation files
- Number of peaks and number of annotated peaks
- Specified queries, and value of the priority flag
- Number of peaks per query

**Graphs based on the 'finalhits' output:**

- Density plot displaying the distance per feature across all queries (Figure 1B)
- Pie chart illustrating the genomic locations of the peaks per annotated feature (Figure 1C)
- Bar plot displaying the occurrence of the different features, if there is more than one feature assigned for peak annotation (not illustrated due to one feature in this example)

*Figure 1A-C would be the summary for the first example UROPA run given above with only one query*

.. figure:: img/output-formats-summary.png
